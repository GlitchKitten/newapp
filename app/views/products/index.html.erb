<h3>Products</h3>

<table>  
  <tbody>
    <% cache (cache_key_for_products) do %>
      <% @products.each do |product| %>
        <% cache product do %>
        <tr>
          <td><%= image_tag(product.image_url)%></td>
          <td>
            <ul>
              <li><strong><%= product.name%></strong></li>
              <li><%= product.description %></li>
              <li><strong>Colour: </strong><%= product.colour %></li>
              <li><strong>$<%= product.price %></strong></li>         <li><strong>In stock: </strong><%= product.stock %></li>
              <br>
              <li><%= link_to 'More Detail', product %></li>
              <% if signed_in? && current_user.admin? %>
                <li><%= link_to 'Edit', edit_product_path(product) %></li>
                <li><%= link_to 'Destroy', product, :method => :delete, data: {confirm: "Are you sure you want to delete?"}%></li>
              <% end %>
            </ul>
          </td>
        </tr>
        <%end%>
      <%end%>
    <%end%>
  </tbody>
</table>

<br>
  
<% if signed_in? && current_user.admin? %>
  <%= link_to 'New Product', new_product_path %>
<% end %>